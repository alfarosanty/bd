-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;

CREATE DATABASE "BD"
    WITH
    OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'Spanish_Argentina.1252'
    LC_CTYPE = 'Spanish_Argentina.1252'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1
    IS_TEMPLATE = False;


CREATE TABLE IF NOT EXISTS public."ARTICULO"
(
    "ID_ARTICULO" serial NOT NULL,
    "DESCRIPCION" text COLLATE pg_catalog."default",
    "PRECIO1" numeric,
    "PRECIO2" numeric,
    "PRECIO3" numeric,
    "ULTIMO_PRECIO" date,
    "CODIGO" text COLLATE pg_catalog."default",
    "ID_COLOR" INT,
    "ID_MEDIDA" INT,
    "ID_FAMILIA" INT,
    "ID_FABICANTE" INT,
    "ID_CATEGORIA" INT NOT NULL,
    CONSTRAINT "ARTICULO_pkey" PRIMARY KEY ("ID_ARTICULO")
);

CREATE TABLE IF NOT EXISTS public."ARTICULO_INGRESO"
(
    "ID_ARTICULO_INGRESO" serial NOT NULL,
    "ID_ARTICULO" INT,
    "ID_INGRESO" INT,
    "CANTIDAD" INT,
    CONSTRAINT "ARTICULO_INGRESO_pkey" PRIMARY KEY ("ID_ARTICULO_INGRESO")
);

CREATE TABLE IF NOT EXISTS public."ARTICULO_PRESUPUESTO"
(
    "ID_ARTICULO_PRESUPUESTO" serial NOT NULL,
    "ID_PRESUPUESTO" INT,
    "ID_ARTICULO" INT,
    "PRECIO_UNITARIO" numeric,
    "CANTIDAD" INT,
    "PENDIENTE" INT,
    CONSTRAINT "ARTICULO_PRESUPUESTO_pkey" PRIMARY KEY ("ID_ARTICULO_PRESUPUESTO"),
    CONSTRAINT "ID_ARTICULO" UNIQUE ("ID_ARTICULO")
        INCLUDE("ID_ARTICULO"),
    CONSTRAINT "ID_PRESUPUESTO" UNIQUE ("ID_PRESUPUESTO")
        INCLUDE("ID_PRESUPUESTO")
);

CREATE TABLE IF NOT EXISTS public."CATEGORIA"
(
    "ID_CATEGORIA" serial NOT NULL,
    "CODIGO" text COLLATE pg_catalog."default",
    "DESCRIPCION" text COLLATE pg_catalog."default",
    CONSTRAINT "CATEGORIA_pkey" PRIMARY KEY ("ID_CATEGORIA")
);

CREATE TABLE IF NOT EXISTS public."CLIENTE"
(
    "ID_CLIENTE" serial NOT NULL,
    "RAZON_SOCIAL" text COLLATE pg_catalog."default",
    "TELEFONO" text COLLATE pg_catalog."default",
    "CONTACTO" text COLLATE pg_catalog."default",
    "DOMICILIO" text COLLATE pg_catalog."default",
    "LOCALIDAD" text COLLATE pg_catalog."default",
    "ID_PROVINCIA" INT,
    "CUIT" text COLLATE pg_catalog."default",
    "ID_CONDICION_AFIP" INT,
    CONSTRAINT "CLIENTE_pkey" PRIMARY KEY ("ID_CLIENTE")
);

CREATE TABLE IF NOT EXISTS public."COLOR"
(
    "ID_COLOR" serial NOT NULL,
    "CODIGO" text COLLATE pg_catalog."default",
    "DESCRIPCION" text COLLATE pg_catalog."default",
    CONSTRAINT "COLOR_pkey" PRIMARY KEY ("ID_COLOR")
);

CREATE TABLE IF NOT EXISTS public."CONDICION_AFIP"
(
    "ID_CONDICION" serial NOT NULL,
    "CODIGO" text COLLATE pg_catalog."default",
    "DESCRIPCION" text COLLATE pg_catalog."default",
    CONSTRAINT "CONDICION_AFIP_pkey" PRIMARY KEY ("ID_CONDICION")
);

CREATE TABLE IF NOT EXISTS public."ESTADO_PEDIDO_PRODUCCION"
(
    "ID_ESTADO_PRODUCCION" serial NOT NULL,
    "CODIGO" text COLLATE pg_catalog."default",
    "DESCRIPCION" text COLLATE pg_catalog."default",
    CONSTRAINT "ESTADO_PEDIDO_PRODUCCION_pkey" PRIMARY KEY ("ID_ESTADO_PRODUCCION")
);

CREATE TABLE IF NOT EXISTS public."ESTADO_PRESUPUESTO"
(
    "ID_ESTADO" serial NOT NULL,
    "CODIGO" text COLLATE pg_catalog."default",
    "DESCRIPCION" text COLLATE pg_catalog."default",
    CONSTRAINT "ESTADO_PRESUPUESTO_pkey" PRIMARY KEY ("ID_ESTADO")
);

CREATE TABLE IF NOT EXISTS public."FABRICANTE"
(
    "ID_FABRICANTE" serial NOT NULL,
    "CODIGO" text COLLATE pg_catalog."default",
    "DESCRIPCION" text COLLATE pg_catalog."default",
    CONSTRAINT "FABRICANTE_pkey" PRIMARY KEY ("ID_FABRICANTE")
);

CREATE TABLE IF NOT EXISTS public."FACTURA"
(
    "ID_FACTURA" serial NOT NULL,
    "ID_CLIENTE" INT,
    "FECHA" date,
    "TOTAL" numeric,
    CONSTRAINT "FACTURA_pkey" PRIMARY KEY ("ID_FACTURA")
);

CREATE TABLE IF NOT EXISTS public."FACTURA_ARTICULO"
(
    "ID_FACTURA_ARTICULO" serial NOT NULL,
    "ID_FACTURA" INT NOT NULL,
    "ID_ARTICULO" INT NOT NULL,
    "CANTIDAD" INT NOT NULL,
    "PRECIO" numeric NOT NULL,
    CONSTRAINT "FACTURA_PRESUPUESTO_pkey" PRIMARY KEY ("ID_FACTURA_ARTICULO")
);

CREATE TABLE IF NOT EXISTS public."FAMILIA"
(
    "ID_FAMILIA" serial NOT NULL,
    "CODIGO" text COLLATE pg_catalog."default",
    "DESCRIPCION" text COLLATE pg_catalog."default",
    CONSTRAINT "FAMILIA_pkey" PRIMARY KEY ("ID_FAMILIA")
);

CREATE TABLE IF NOT EXISTS public."INGRESO"
(
    "ID_INGRESO" serial NOT NULL,
    "FECHA" date,
    "ID_FABRICANTE" INT,
    "DESCRIPCION" text COLLATE pg_catalog."default",
    CONSTRAINT "INGRESO_pkey" PRIMARY KEY ("ID_INGRESO")
);

CREATE TABLE IF NOT EXISTS public."MEDIDA"
(
    "ID_MEDIDA" serial NOT NULL,
    "CODIGO" text COLLATE pg_catalog."default",
    "DESCRIPCION" text COLLATE pg_catalog."default",
    CONSTRAINT "MEDIDA_pkey" PRIMARY KEY ("ID_MEDIDA")
);

CREATE TABLE IF NOT EXISTS public."PEDIDO_PRODUCCION"
(
    "ID_PEDIDO_PRODUCCION" serial NOT NULL,
    "FECHA" date,
    "ID_FABRICANTE" INT,
    "ID_ESTADO_PEDIDO_PROD" INT,
    CONSTRAINT "PEDIDO_PRODUCCION_pkey" PRIMARY KEY ("ID_PEDIDO_PRODUCCION")
);

CREATE TABLE IF NOT EXISTS public."PRESUPUESTO"
(
    "ID_PRESUPUESTO" serial NOT NULL,
    "FECHA_PRESUPUESTO" date,
    "ID_CLIENTE" INT,
    "EXMIR_IVA" boolean,
    "ID_ESTADO" INT,
    "TOTAL_PRESUPUESTO" INT,
    "ID_FACTURA" INT,
    CONSTRAINT "PRESUPUESTO_pkey" PRIMARY KEY ("ID_PRESUPUESTO")
);

CREATE TABLE IF NOT EXISTS public."PRODUCCION_ARTICULO"
(
    "ID_PRODUCCION_ARTICULO" serial NOT NULL,
    "ID_ARTICULO" INT,
    "ID_PEDIDO_PRODUCCION" INT,
    "CANTIDAD" INT,
    "CANT_PENDIENTE" INT,
    "ID_ARTICULO_PRESUPUESTO" INT,
    CONSTRAINT "PRODUCCION_ARTICULO_pkey" PRIMARY KEY ("ID_PRODUCCION_ARTICULO")
);

ALTER TABLE IF EXISTS public."ARTICULO"
    ADD CONSTRAINT "CATEGORIA" FOREIGN KEY ("ID_CATEGORIA")
    REFERENCES public."CATEGORIA" ("ID_CATEGORIA") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "fki_CATEGORIA"
    ON public."ARTICULO"("ID_CATEGORIA");


ALTER TABLE IF EXISTS public."ARTICULO"
    ADD CONSTRAINT "COLOR" FOREIGN KEY ("ID_COLOR")
    REFERENCES public."COLOR" ("ID_COLOR") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."ARTICULO"
    ADD CONSTRAINT "FABRICANTE" FOREIGN KEY ("ID_FABICANTE")
    REFERENCES public."FABRICANTE" ("ID_FABRICANTE") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "fki_FABRICANTE"
    ON public."ARTICULO"("ID_FABICANTE");


ALTER TABLE IF EXISTS public."ARTICULO"
    ADD CONSTRAINT "FAMILIA" FOREIGN KEY ("ID_FAMILIA")
    REFERENCES public."FAMILIA" ("ID_FAMILIA") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "fki_FAMILIA"
    ON public."ARTICULO"("ID_FAMILIA");


ALTER TABLE IF EXISTS public."ARTICULO"
    ADD CONSTRAINT "MEDIDA" FOREIGN KEY ("ID_MEDIDA")
    REFERENCES public."MEDIDA" ("ID_MEDIDA") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."ARTICULO_INGRESO"
    ADD CONSTRAINT "ARTICULO" FOREIGN KEY ("ID_ARTICULO")
    REFERENCES public."ARTICULO" ("ID_ARTICULO") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."ARTICULO_INGRESO"
    ADD CONSTRAINT "INGRESO" FOREIGN KEY ("ID_INGRESO")
    REFERENCES public."INGRESO" ("ID_INGRESO") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "fki_INGRESO"
    ON public."ARTICULO_INGRESO"("ID_INGRESO");


ALTER TABLE IF EXISTS public."ARTICULO_PRESUPUESTO"
    ADD CONSTRAINT "ARTICULO" FOREIGN KEY ("ID_ARTICULO")
    REFERENCES public."ARTICULO" ("ID_ARTICULO") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "ID_ARTICULO"
    ON public."ARTICULO_PRESUPUESTO"("ID_ARTICULO");


ALTER TABLE IF EXISTS public."ARTICULO_PRESUPUESTO"
    ADD CONSTRAINT "PRESUPUESTO" FOREIGN KEY ("ID_PRESUPUESTO")
    REFERENCES public."PRESUPUESTO" ("ID_PRESUPUESTO") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "ID_PRESUPUESTO"
    ON public."ARTICULO_PRESUPUESTO"("ID_PRESUPUESTO");


ALTER TABLE IF EXISTS public."CLIENTE"
    ADD CONSTRAINT "CONDICION_AFIP" FOREIGN KEY ("ID_CONDICION_AFIP")
    REFERENCES public."CONDICION_AFIP" ("ID_CONDICION") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;
CREATE INDEX IF NOT EXISTS "fki_CONDICION_AFIP"
    ON public."CLIENTE"("ID_CONDICION_AFIP");


ALTER TABLE IF EXISTS public."FACTURA"
    ADD CONSTRAINT "CLIENTE" FOREIGN KEY ("ID_CLIENTE")
    REFERENCES public."CLIENTE" ("ID_CLIENTE") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."FACTURA_ARTICULO"
    ADD CONSTRAINT "ARTICULO" FOREIGN KEY ("ID_ARTICULO")
    REFERENCES public."ARTICULO" ("ID_ARTICULO") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "fki_ARTICULO"
    ON public."FACTURA_ARTICULO"("ID_ARTICULO");


ALTER TABLE IF EXISTS public."FACTURA_ARTICULO"
    ADD CONSTRAINT "FACTURA" FOREIGN KEY ("ID_FACTURA_ARTICULO")
    REFERENCES public."FACTURA" ("ID_FACTURA") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS "FACTURA_PRESUPUESTO_pkey"
    ON public."FACTURA_ARTICULO"("ID_FACTURA_ARTICULO");


ALTER TABLE IF EXISTS public."INGRESO"
    ADD CONSTRAINT "FABRICANTE" FOREIGN KEY ("ID_FABRICANTE")
    REFERENCES public."FABRICANTE" ("ID_FABRICANTE") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."PEDIDO_PRODUCCION"
    ADD CONSTRAINT "ESSTADO_PEDIDO_PRODUCCION" FOREIGN KEY ("ID_ESTADO_PEDIDO_PROD")
    REFERENCES public."ESTADO_PEDIDO_PRODUCCION" ("ID_ESTADO_PRODUCCION") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."PEDIDO_PRODUCCION"
    ADD CONSTRAINT "FABRICANTE" FOREIGN KEY ("ID_FABRICANTE")
    REFERENCES public."FABRICANTE" ("ID_FABRICANTE") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."PRESUPUESTO"
    ADD CONSTRAINT "CLIENTE_FK" FOREIGN KEY ("ID_CLIENTE")
    REFERENCES public."CLIENTE" ("ID_CLIENTE") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."PRESUPUESTO"
    ADD CONSTRAINT "ESTADO_FK" FOREIGN KEY ("ID_ESTADO")
    REFERENCES public."ESTADO_PRESUPUESTO" ("ID_ESTADO") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."PRESUPUESTO"
    ADD CONSTRAINT "FACTURA" FOREIGN KEY ("ID_FACTURA")
    REFERENCES public."FACTURA" ("ID_FACTURA") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;
CREATE INDEX IF NOT EXISTS "fki_FACTURA"
    ON public."PRESUPUESTO"("ID_FACTURA");


ALTER TABLE IF EXISTS public."PRODUCCION_ARTICULO"
    ADD CONSTRAINT "ARTICULO" FOREIGN KEY ("ID_ARTICULO")
    REFERENCES public."ARTICULO" ("ID_ARTICULO") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."PRODUCCION_ARTICULO"
    ADD CONSTRAINT "ARTICULO_PRESUPUESTO" FOREIGN KEY ("ID_ARTICULO_PRESUPUESTO")
    REFERENCES public."ARTICULO_PRESUPUESTO" ("ID_ARTICULO_PRESUPUESTO") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."PRODUCCION_ARTICULO"
    ADD CONSTRAINT "PRODUCCION_ARTICULO" FOREIGN KEY ("ID_PEDIDO_PRODUCCION")
    REFERENCES public."PEDIDO_PRODUCCION" ("ID_PEDIDO_PRODUCCION") MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;